# Switch to root user to execute the task
sudo su -

# Create a group called "dba_users" and add the user
# called 'bob' to this group

# Create group called dba_users
groupadd dba_users
# Append user bob into dba_users
usermod -a -G dba_users bob

# Install the correct packages that will allow the 
# use of "lvm" on the centos machine.

## Install lvm using dnf

dnf install -y lvm2

#Create a Physical Volume from two block devices

## Create PVs using pvcreate command

pvcreate /dev/vdb
pvcreate /dev/vdc

# Create a volume group called "dba_storage" using 
# the physical volumes /dev/vdb abd /dev/vdc

## Create Volume group that will combine the two physical
## volume /dev/vdb and /dev/vdc

vgcreate dba_storage /dev/vdb /dev/vdc

# Create an "lvm" called "volume_1" from the volume group 
# called "dba_storage".Make use of the entire space available 
# in the volume group.

## Create LVM while utilizing all available space of the 
## combined volume group

lvcreate -l 100%FREE -n volume_1 dba_storage

## Create the file system on logical volume
mkfs.xfs /dev/dba_storage/volume_1
# Make directory for mounting 
mkdir -p /mnt/dba_storage
# mount the file system on logical volume 
mount /dev/dba_storage/volume_1 /mnt/dba_storage
# Make persistent
echo "/dev/mapper/dba_storage-volume_1 /mnt/dba_storage xfs defaults 0 0" >> /etc/fstab
# Ensure that the mountpoint "/mnt/dba_storage" has 
# the group ownership set to the "dba_users" group
chgrp dba_users /mnt/dba_storage
# Ensure that the mount point "/mnt/dba_storage" has 
# "read/write" and execute permissions for the owner 
# and group and no permissions for anyone else.
chmod 770 /mnt/dba_storage

