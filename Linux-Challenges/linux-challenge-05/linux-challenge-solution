# Switch to root user to complete task
sudo su -

# Install "mariadb" database server & "start/enable" its service.
dnf install -y mariadb*
systemctl enable mariadb && systemctl start mariadb

# Add new IP to the physical interface eth1
ip addr add 10.0.0.50/24 dev eth1

# Add a local DNS entry for the database hostname "mydb.kodekloud.com" 
# so that it can resolve to "10.0.0.50" IP address.

chmod 777 /etc/hosts # change permission of hostfile
vi /etc/hosts        # Add local Dns entry
cat /etc/hosts       # Check the added DNS entry
10.0.0.50    mydb.kodekloud.com 

# Set a password for mysql root user as instructed in task
mysqladmin -u root password 'S3cure#321'

# Unlock currently locked "root" account
usermod -U root

# Make user "root" a member of "wheel" group
usermod -a -G wheel root

# Edit the PAM configuration file for the "su" utility so that this utility 
# only accepts the requests from the users that are part of the "wheel" group
#
# use find command to find the location of su utility file
find /etc/ -type f -name su # This will give absolute path for su utility file
sed -i 's/#auth/auth/' /etc/pam.d/su

# Pull "nginx" docker image and run container myapp
docker pull nginx
docker run -d --name myapp -p 80:80 nginx

# Create script file to start container
vi /home/bob/container-start.sh
cat /home/bob/container-start.sh
#content of cat command
#
#!/usr/bin/env bash
docker start myapp
echo "myapp container started!"
# Create script file to stop container 
vi /home/bob/container-stop.sh
cat /home/bob/container-stop.sh
#content of cat command
#
#!/usr/bin/env bash
docker stop myapp
echo "myapp container stopped!"

# Make script files executable

chmod +x /home/bob/container-start.sh 
chmod +x /home/bob/container-stop.sh 

# Add a cron job for the "root" user which should run 
# scripts for starting and stopping containers at different time

crontab -l # command to list current task of root user
crontab -e # command to add task for root user

0 0 * * * /home/bob/container-stop.sh
0 8 * * * /home/bob/container-start.sh

